/*   
Template Name: Color Admin - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.7 & Bootstrap 4.0.0-Alpha 6
Version: 3.0.0
Author: Sean Ngu
Website: http://www.seantheme.com/color-admin-v3.0/admin/material/
*/var getMonthName=function(a){var b=[];return b[0]="January",b[1]="February",b[2]="March",b[3]="April",b[4]="May",b[5]="Jun",b[6]="July",b[7]="August",b[8]="September",b[9]="October",b[10]="November",b[11]="December",b[a]},getDate=function(a){var b=new Date(a),c=b.getDate(),d=b.getMonth()+1,e=b.getFullYear();return c<10&&(c="0"+c),d<10&&(d="0"+d),b=e+"-"+d+"-"+c},handleVisitorsLineChart=function(){var a="#009688",b="#4DB6AC",c="#2196F3",d="#03A9F4",e="rgba(0,0,0,0.5)",f="rgba(255,255,255,0.5)";Morris.Line({element:"visitors-line-chart",data:[{x:"2014-02-01",y:60,z:30},{x:"2014-03-01",y:70,z:40},{x:"2014-04-01",y:40,z:10},{x:"2014-05-01",y:100,z:70},{x:"2014-06-01",y:40,z:10},{x:"2014-07-01",y:80,z:50},{x:"2014-08-01",y:70,z:40}],xkey:"x",ykeys:["y","z"],xLabelFormat:function(a){return a=getMonthName(a.getMonth()),a.toString()},labels:["Page Views","Unique Visitors"],lineColors:[a,c],pointFillColors:[b,d],lineWidth:"2px",pointStrokeColors:[e,e],resize:!0,gridTextFamily:"Roboto",gridTextColor:f,gridTextWeight:"normal",gridTextSize:"11px",gridLineColor:"rgba(0,0,0,0.5)",hideHover:"auto"})},handleVisitorsDonutChart=function(){var a="#009688",b="#2196F3";Morris.Donut({element:"visitors-donut-chart",data:[{label:"New Visitors",value:900},{label:"Return Visitors",value:1200}],colors:[a,b],labelFamily:"Roboto",labelColor:"rgba(255,255,255,0.5)",labelTextSize:"11px",backgroundColor:"#000"})},handleVisitorsVectorMap=function(){0!==$("#visitors-map").length&&$("#visitors-map").vectorMap({map:"world_merc_en",scaleColors:["#616161","#616161"],container:$("#visitors-map"),normalizeFunction:"linear",hoverOpacity:.5,hoverColor:!1,markerStyle:{initial:{fill:"#616161",stroke:"transparent",r:3}},regions:[{attribute:"fill"}],regionStyle:{initial:{fill:"#616161","fill-opacity":1,stroke:"none","stroke-width":.4,"stroke-opacity":1},hover:{"fill-opacity":.8},selected:{fill:"yellow"},selectedHover:{}},series:{regions:[{values:{IN:"#E91E63",US:"#E91E63",KR:"#E91E63"}}]},focusOn:{x:.5,y:.5,scale:2},backgroundColor:"#212121"})},handleScheduleCalendar=function(){var a=["January","February","March","April","May","June","July","August","September","October","November","December"],b=["S","M","T","W","T","F","S"],c=new Date,d=c.getMonth()+1,e=c.getFullYear(),f=[["2/"+d+"/"+e,"Popover Title","#","#009688","Some contents here"],["5/"+d+"/"+e,"Tooltip with link","http://www.seantheme.com/color-admin-v1.3","#212121"],["18/"+d+"/"+e,"Popover with HTML Content","#","#212121",'Some contents here <div class="text-right"><a href="http://www.google.com">view more >>></a></div>'],["28/"+d+"/"+e,"Color Admin V1.3 Launched","http://www.seantheme.com/color-admin-v1.3","#212121"]],g=$("#schedule-calendar");$(g).calendar({months:a,days:b,events:f,popover_options:{placement:"top",html:!0}}),$(g).find("td.event").each(function(){var a=$(this).css("background-color");$(this).removeAttr("style"),$(this).find("a").css("background-color",a)}),$(g).find(".icon-arrow-left, .icon-arrow-right").parent().on("click",function(){$(g).find("td.event").each(function(){var a=$(this).css("background-color");$(this).removeAttr("style"),$(this).find("a").css("background-color",a)})})},DashboardV2=function(){"use strict";return{init:function(){handleVisitorsLineChart(),handleVisitorsDonutChart(),handleVisitorsVectorMap(),handleScheduleCalendar(),handleDashboardGritterNotification()}}}();*/

    $.ajax({
        'async': false,
        'global': false,
        'url': 'https://api.blockchain.info/charts/market-price?timespan=30days&format=json',
        'dataType': "json",
        'success': function (data) {
            json = data;
            
        }
    });

        

function timeConverter(UNIX_timestamp){
    var a = new Date(UNIX_timestamp * 1000);
    var months = ['1','2','3','4','5','6','7','8','9','10','11','12'];;
    var year = a.getFullYear();
    var month = months[a.getMonth()];
    var date = a.getDate();
    var hour = a.getHours();
    var min = a.getMinutes();
    var sec = a.getSeconds();
    var time = year + '-' + month + '-' + date ;
    return time;
  }

var market_price_data = json;
console.log(market_price_data);   
    var count=0;
    var values = market_price_data["values"];
    var len = values.length;
    var sumTotalPrice = 0;
    for (var i = 0; i < values.length; i++) {
        sumTotalPrice += values[i].y; //sum all the price in the array
    }
    console.log(sumTotalPrice);
    var result = {
                                    feed: {
                                        entries: []
                                    }
                                };
                             for(count; count<(len);count++){

                             
                                var yr="";
                                var value=0;
                                yr=values[count]['x'];
                                yr=timeConverter(yr);
                               // console.log(yr);
                                value=values[count]['y'];         
                                result.feed.entries.push({
                                        year: yr,
                                        prices: value  
                                        });
                             }
                             //console.log(result);

var getMonthName = function(a) {
    var b = [];
    return b[0] = "January", b[1] = "February", b[2] = "March", b[3] = "April", b[4] = "May", b[5] = "Jun",
     b[6] = "July", b[7] = "August", b[8] = "September", b[9] = "October", b[10] = "November",
     b[11] = "December", b[a]
},
getDate = function(a) {
    var b = new Date(a),
        c = b.getDate(),
        d = b.getMonth() + 1,
        e = b.getFullYear();
    return c < 10 && (c = "0" + c), d < 10 && (d = "0" + d), b = e + "-" + d + "-" + c
},
handleBitCoinMarketPriceLineChart = function() {
    var a = "#009688",
        b = "#4DB6AC",
        c = "#2196F3",
        d = "#03A9F4",
        e = "rgba(0,0,0,0.5)",
        f = "rgba(255,255,255,0.5)";


        //var result = JSON.parse(json);


    Morris.Line({
        element: "nano-bitcoinmarket-line-chart",
        data: result.feed.entries,
        xkey: "year",
        ykeys: ["prices"],
        xLabelFormat: function(a) {
            return a = getMonthName(a.getMonth()), a.toString()
        },
        labels: ["USD Price"],
        lineColors: [a, c],
        pointFillColors: [b, d],
        lineWidth: "2px",
        pointStrokeColors: [e, e],
        resize: !0,
        gridTextFamily: "Roboto",
        gridTextColor: f,
        gridTextWeight: "normal",
        gridTextSize: "11px",
        gridLineColor: "rgba(0,0,0,0.5)",
        hideHover: "auto"
    })
},
handleBitCoinVsDonutChart = function() {
    var a = "#009688",
        b = "#2196F3";
    Morris.Donut({
        element: "bitcointotal-donut-chart",
        data: [{
            label: "USD",
            value: 900
        }, {
            label: "USD",
            value: sumTotalPrice
        }],
        colors: [a, b],
        labelFamily: "Roboto",
        labelColor: "rgba(255,255,255,0.5)",
        labelTextSize: "11px",
        backgroundColor: "#000"
    })
},
DashboardV2 = function() {
    "use strict";
    return {
        init: function() {
            handleBitCoinMarketPriceLineChart(),handleBitCoinVsDonutChart()
        }
    }
}();